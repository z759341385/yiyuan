{"remainingRequest":"/Users/zhc/project/yiyuan/node_modules/thread-loader/dist/cjs.js!/Users/zhc/project/yiyuan/node_modules/babel-loader/lib/index.js!/Users/zhc/project/yiyuan/public/svg-progress-bar.js","dependencies":[{"path":"/Users/zhc/project/yiyuan/public/svg-progress-bar.js","mtime":1633672657446},{"path":"/Users/zhc/project/yiyuan/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhc/project/yiyuan/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhc/project/yiyuan/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7Cgp2YXIgX3R5cGVvZiA9IHJlcXVpcmUoIi9Vc2Vycy96aGMvcHJvamVjdC95aXl1YW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIik7CgooZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkgewogIGlmICgodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGV4cG9ydHMpKSA9PT0gJ29iamVjdCcgJiYgKHR5cGVvZiBtb2R1bGUgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG1vZHVsZSkpID09PSAnb2JqZWN0JykgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7ZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGZhY3RvcnkpO2Vsc2UgaWYgKCh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpID09PSAnb2JqZWN0JykgZXhwb3J0c1sic3ZnUHJvZ3Jlc3NCYXIiXSA9IGZhY3RvcnkoKTtlbHNlIHJvb3RbInN2Z1Byb2dyZXNzQmFyIl0gPSBmYWN0b3J5KCk7Cn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICgKICAgIC8qKioqKiovCiAgICBmdW5jdGlvbiAobW9kdWxlcykgewogICAgICAvLyB3ZWJwYWNrQm9vdHN0cmFwCgogICAgICAvKioqKioqLwogICAgICAvLyBUaGUgbW9kdWxlIGNhY2hlCgogICAgICAvKioqKioqLwogICAgICB2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KCiAgICAgIC8qKioqKiovCgogICAgICBmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7CiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgLyoqKioqKi8KICAgICAgICAvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKCiAgICAgICAgLyoqKioqKi8KICAgICAgICBpZiAoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICByZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgfQogICAgICAgIC8qKioqKiovCiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKCiAgICAgICAgLyoqKioqKi8KCgogICAgICAgIHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICBpOiBtb2R1bGVJZCwKCiAgICAgICAgICAvKioqKioqLwogICAgICAgICAgbDogZmFsc2UsCgogICAgICAgICAgLyoqKioqKi8KICAgICAgICAgIGV4cG9ydHM6IHt9CiAgICAgICAgICAvKioqKioqLwoKICAgICAgICB9OwogICAgICAgIC8qKioqKiovCgogICAgICAgIC8qKioqKiovCiAgICAgICAgLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCgogICAgICAgIC8qKioqKiovCgogICAgICAgIG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwogICAgICAgIC8qKioqKiovCgogICAgICAgIC8qKioqKiovCiAgICAgICAgLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAoKICAgICAgICAvKioqKioqLwoKICAgICAgICBtb2R1bGUubCA9IHRydWU7CiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgLyoqKioqKi8KICAgICAgICAvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQoKICAgICAgICAvKioqKioqLwoKICAgICAgICByZXR1cm4gbW9kdWxlLmV4cG9ydHM7CiAgICAgICAgLyoqKioqKi8KICAgICAgfQogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCgogICAgICAvKioqKioqLwoKCiAgICAgIF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwogICAgICAvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZQoKICAgICAgLyoqKioqKi8KCiAgICAgIF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7CiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwogICAgICAvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKCiAgICAgIC8qKioqKiovCgogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbiAoZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7CiAgICAgICAgLyoqKioqKi8KICAgICAgICBpZiAoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkgewogICAgICAgICAgLyoqKioqKi8KICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7CiAgICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCgogICAgICAgICAgICAvKioqKioqLwogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAoKICAgICAgICAgICAgLyoqKioqKi8KICAgICAgICAgICAgZ2V0OiBnZXR0ZXIKICAgICAgICAgICAgLyoqKioqKi8KCiAgICAgICAgICB9KTsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgfQogICAgICAgIC8qKioqKiovCgogICAgICB9OwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXMKCiAgICAgIC8qKioqKiovCgoKICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24gKG1vZHVsZSkgewogICAgICAgIC8qKioqKiovCiAgICAgICAgdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/CiAgICAgICAgLyoqKioqKi8KICAgICAgICBmdW5jdGlvbiBnZXREZWZhdWx0KCkgewogICAgICAgICAgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOwogICAgICAgIH0gOgogICAgICAgIC8qKioqKiovCiAgICAgICAgZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsKICAgICAgICAgIHJldHVybiBtb2R1bGU7CiAgICAgICAgfTsKICAgICAgICAvKioqKioqLwoKICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7CiAgICAgICAgLyoqKioqKi8KCgogICAgICAgIHJldHVybiBnZXR0ZXI7CiAgICAgICAgLyoqKioqKi8KICAgICAgfTsKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbAoKICAgICAgLyoqKioqKi8KCgogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbiAob2JqZWN0LCBwcm9wZXJ0eSkgewogICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7CiAgICAgIH07CiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwogICAgICAvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwoKICAgICAgLyoqKioqKi8KCgogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwoKICAgICAgLyoqKioqKi8KCiAgICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApOwogICAgICAvKioqKioqLwogICAgfSgKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogICAgLyoqKioqKi8KICAgIFsKICAgIC8qIDAgKi8KCiAgICAvKioqLwogICAgZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAidXNlIHN0cmljdCI7CgogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgICAgICAgdmFsdWU6IHRydWUKICAgICAgfSk7CgogICAgICB2YXIgX3Byb2dyZXNzQmFyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKCiAgICAgIHZhciBfcHJvZ3Jlc3NCYXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvZ3Jlc3NCYXIpOwoKICAgICAgZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICAgICAgICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgICAgICAgZGVmYXVsdDogb2JqCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgX3Byb2dyZXNzQmFyMi5kZWZhdWx0Lmluc3RhbGwgPSBmdW5jdGlvbiAoVnVlKSB7CiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICAgIFZ1ZS5jb21wb25lbnQob3B0aW9ucy5jb21wb25lbnROYW1lIHx8IF9wcm9ncmVzc0JhcjIuZGVmYXVsdC5uYW1lLCBfcHJvZ3Jlc3NCYXIyLmRlZmF1bHQpOwogICAgICB9OwoKICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WdWUpIHsKICAgICAgICBWdWUuY29tcG9uZW50KF9wcm9ncmVzc0JhcjIuZGVmYXVsdC5uYW1lLCBfcHJvZ3Jlc3NCYXIyLmRlZmF1bHQpOwogICAgICB9CgogICAgICBleHBvcnRzLmRlZmF1bHQgPSBfcHJvZ3Jlc3NCYXIyLmRlZmF1bHQ7CiAgICAgIC8qKiovCiAgICB9LAogICAgLyogMSAqLwoKICAgIC8qKiovCiAgICBmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgIC8qIHN0eWxlcyAqLwogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwoKICAgICAgdmFyIENvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oNykoCiAgICAgIC8qIHNjcmlwdCAqLwogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLAogICAgICAvKiB0ZW1wbGF0ZSAqLwogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKSwKICAgICAgLyogc2NvcGVJZCAqLwogICAgICBudWxsLAogICAgICAvKiBjc3NNb2R1bGVzICovCiAgICAgIG51bGwpOwoKICAgICAgQ29tcG9uZW50Lm9wdGlvbnMuX19maWxlID0gIi9Vc2Vycy9jaGVueHVhbi9Eb2N1bWVudHMvZ2l0aHViL3N2Zy1wcm9ncmVzcy1iYXIvc3JjL2NvbXBvbmVudHMvcHJvZ3Jlc3MtYmFyLnZ1ZSI7CgogICAgICBpZiAoQ29tcG9uZW50LmVzTW9kdWxlICYmIE9iamVjdC5rZXlzKENvbXBvbmVudC5lc01vZHVsZSkuc29tZShmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgcmV0dXJuIGtleSAhPT0gImRlZmF1bHQiICYmIGtleSAhPT0gIl9fZXNNb2R1bGUiOwogICAgICB9KSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIm5hbWVkIGV4cG9ydHMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gKi52dWUgZmlsZXMuIik7CiAgICAgIH0KCiAgICAgIGlmIChDb21wb25lbnQub3B0aW9ucy5mdW5jdGlvbmFsKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiW3Z1ZS1sb2FkZXJdIHByb2dyZXNzLWJhci52dWU6IGZ1bmN0aW9uYWwgY29tcG9uZW50cyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIHRlbXBsYXRlcywgdGhleSBzaG91bGQgdXNlIHJlbmRlciBmdW5jdGlvbnMuIik7CiAgICAgIH0KICAgICAgLyogaG90IHJlbG9hZCAqLwoKCiAgICAgIGlmIChmYWxzZSkgewogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgaG90QVBJID0gcmVxdWlyZSgidnVlLWxvYWRlci9ub2RlX21vZHVsZXMvdnVlLWhvdC1yZWxvYWQtYXBpIik7CgogICAgICAgICAgaG90QVBJLmluc3RhbGwocmVxdWlyZSgidnVlIiksIGZhbHNlKTsKICAgICAgICAgIGlmICghaG90QVBJLmNvbXBhdGlibGUpIHJldHVybjsKICAgICAgICAgIG1vZHVsZS5ob3QuYWNjZXB0KCk7CgogICAgICAgICAgaWYgKCFtb2R1bGUuaG90LmRhdGEpIHsKICAgICAgICAgICAgaG90QVBJLmNyZWF0ZVJlY29yZCgiZGF0YS12LTA5YzQ0Y2RjIiwgQ29tcG9uZW50Lm9wdGlvbnMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaG90QVBJLnJlbG9hZCgiZGF0YS12LTA5YzQ0Y2RjIiwgQ29tcG9uZW50Lm9wdGlvbnMpOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgIH0KCiAgICAgIG1vZHVsZS5leHBvcnRzID0gQ29tcG9uZW50LmV4cG9ydHM7CiAgICAgIC8qKiovCiAgICB9LAogICAgLyogMiAqLwoKICAgIC8qKiovCiAgICBmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgIC8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnCiAgICAgIC8vIGxvYWQgdGhlIHN0eWxlcwogICAgICB2YXIgY29udGVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgogICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaSwgY29udGVudCwgJyddXTsKICAgICAgaWYgKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzOyAvLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NCgogICAgICB2YXIgdXBkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KSgiZmQwOTM1MmEiLCBjb250ZW50LCBmYWxzZSk7IC8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnQKCgogICAgICBpZiAoZmFsc2UpIHsKICAgICAgICAvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFncwogICAgICAgIGlmICghY29udGVudC5sb2NhbHMpIHsKICAgICAgICAgIG1vZHVsZS5ob3QuYWNjZXB0KCIhIS4uLy4uL25vZGVfbW9kdWxlcy9fY3NzLWxvYWRlckAwLjI1LjBAY3NzLWxvYWRlci9pbmRleC5qcyEuLi8uLi9ub2RlX21vZHVsZXMvX3Z1ZS1sb2FkZXJAMTEuMy40QHZ1ZS1sb2FkZXIvbGliL3N0eWxlLWNvbXBpbGVyL2luZGV4LmpzP3tcImlkXCI6XCJkYXRhLXYtMDljNDRjZGNcIixcInNjb3BlZFwiOmZhbHNlLFwiaGFzSW5saW5lQ29uZmlnXCI6ZmFsc2V9IS4uLy4uL25vZGVfbW9kdWxlcy9fdnVlLWxvYWRlckAxMS4zLjRAdnVlLWxvYWRlci9saWIvc2VsZWN0b3IuanM/dHlwZT1zdHlsZXMmaW5kZXg9MCEuL3Byb2dyZXNzLWJhci52dWUiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBuZXdDb250ZW50ID0gcmVxdWlyZSgiISEuLi8uLi9ub2RlX21vZHVsZXMvX2Nzcy1sb2FkZXJAMC4yNS4wQGNzcy1sb2FkZXIvaW5kZXguanMhLi4vLi4vbm9kZV9tb2R1bGVzL192dWUtbG9hZGVyQDExLjMuNEB2dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlci9pbmRleC5qcz97XCJpZFwiOlwiZGF0YS12LTA5YzQ0Y2RjXCIsXCJzY29wZWRcIjpmYWxzZSxcImhhc0lubGluZUNvbmZpZ1wiOmZhbHNlfSEuLi8uLi9ub2RlX21vZHVsZXMvX3Z1ZS1sb2FkZXJAMTEuMy40QHZ1ZS1sb2FkZXIvbGliL3NlbGVjdG9yLmpzP3R5cGU9c3R5bGVzJmluZGV4PTAhLi9wcm9ncmVzcy1iYXIudnVlIik7CgogICAgICAgICAgICBpZiAodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07CiAgICAgICAgICAgIHVwZGF0ZShuZXdDb250ZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gLy8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFncwoKCiAgICAgICAgbW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHVwZGF0ZSgpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIC8qKiovCgogICAgfSwKICAgIC8qIDMgKi8KCiAgICAvKioqLwogICAgZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpKCk7IC8vIGltcG9ydHMKICAgICAgLy8gbW9kdWxlCgogICAgICBleHBvcnRzLnB1c2goW21vZHVsZS5pLCAiXG5cblxuXG5cbiIsICIiXSk7IC8vIGV4cG9ydHMKCiAgICAgIC8qKiovCiAgICB9LAogICAgLyogNCAqLwoKICAgIC8qKiovCiAgICBmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7CiAgICAgIC8qCiAgICAgIAlNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAogICAgICAJQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYQogICAgICAqLwogICAgICAvLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlcgogICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbGlzdCA9IFtdOyAvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nCgogICAgICAgIGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzW2ldOwoKICAgICAgICAgICAgaWYgKGl0ZW1bMl0pIHsKICAgICAgICAgICAgICByZXN1bHQucHVzaCgiQG1lZGlhICIgKyBpdGVtWzJdICsgInsiICsgaXRlbVsxXSArICJ9Iik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbVsxXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oIiIpOwogICAgICAgIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0CgoKICAgICAgICBsaXN0LmkgPSBmdW5jdGlvbiAobW9kdWxlcywgbWVkaWFRdWVyeSkgewogICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGVzID09PSAic3RyaW5nIikgbW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgIiJdXTsKICAgICAgICAgIHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBpZCA9IHRoaXNbaV1bMF07CiAgICAgICAgICAgIGlmICh0eXBlb2YgaWQgPT09ICJudW1iZXIiKSBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2lkXSA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IG1vZHVsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSBtb2R1bGVzW2ldOyAvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlCiAgICAgICAgICAgIC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zCiAgICAgICAgICAgIC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuCiAgICAgICAgICAgIC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpCgogICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW1bMF0gIT09ICJudW1iZXIiIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7CiAgICAgICAgICAgICAgaWYgKG1lZGlhUXVlcnkgJiYgIWl0ZW1bMl0pIHsKICAgICAgICAgICAgICAgIGl0ZW1bMl0gPSBtZWRpYVF1ZXJ5OwogICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVkaWFRdWVyeSkgewogICAgICAgICAgICAgICAgaXRlbVsyXSA9ICIoIiArIGl0ZW1bMl0gKyAiKSBhbmQgKCIgKyBtZWRpYVF1ZXJ5ICsgIikiOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIGxpc3Q7CiAgICAgIH07CiAgICAgIC8qKiovCgogICAgfSwKICAgIC8qIDUgKi8KCiAgICAvKioqLwogICAgZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAvKgogICAgICAgIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCiAgICAgICAgQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYQogICAgICAgIE1vZGlmaWVkIGJ5IEV2YW4gWW91IEB5eXg5OTA4MDMKICAgICAgKi8KICAgICAgdmFyIGhhc0RvY3VtZW50ID0gdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJzsKCiAgICAgIGlmICh0eXBlb2YgREVCVUcgIT09ICd1bmRlZmluZWQnICYmIERFQlVHKSB7CiAgICAgICAgaWYgKCFoYXNEb2N1bWVudCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd2dWUtc3R5bGUtbG9hZGVyIGNhbm5vdCBiZSB1c2VkIGluIGEgbm9uLWJyb3dzZXIgZW52aXJvbm1lbnQuICcgKyAiVXNlIHsgdGFyZ2V0OiAnbm9kZScgfSBpbiB5b3VyIFdlYnBhY2sgY29uZmlnIHRvIGluZGljYXRlIGEgc2VydmVyLXJlbmRlcmluZyBlbnZpcm9ubWVudC4iKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBsaXN0VG9TdHlsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwogICAgICAvKgogICAgICB0eXBlIFN0eWxlT2JqZWN0ID0gewogICAgICAgIGlkOiBudW1iZXI7CiAgICAgICAgcGFydHM6IEFycmF5PFN0eWxlT2JqZWN0UGFydD4KICAgICAgfQogICAgICAgdHlwZSBTdHlsZU9iamVjdFBhcnQgPSB7CiAgICAgICAgY3NzOiBzdHJpbmc7CiAgICAgICAgbWVkaWE6IHN0cmluZzsKICAgICAgICBzb3VyY2VNYXA6ID9zdHJpbmcKICAgICAgfQogICAgICAqLwoKCiAgICAgIHZhciBzdHlsZXNJbkRvbSA9IHsKICAgICAgICAvKgogICAgICAgICAgW2lkOiBudW1iZXJdOiB7CiAgICAgICAgICAgIGlkOiBudW1iZXIsCiAgICAgICAgICAgIHJlZnM6IG51bWJlciwKICAgICAgICAgICAgcGFydHM6IEFycmF5PChvYmo/OiBTdHlsZU9iamVjdFBhcnQpID0+IHZvaWQ+CiAgICAgICAgICB9CiAgICAgICAgKi8KICAgICAgfTsKICAgICAgdmFyIGhlYWQgPSBoYXNEb2N1bWVudCAmJiAoZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdKTsKICAgICAgdmFyIHNpbmdsZXRvbkVsZW1lbnQgPSBudWxsOwogICAgICB2YXIgc2luZ2xldG9uQ291bnRlciA9IDA7CiAgICAgIHZhciBpc1Byb2R1Y3Rpb24gPSBmYWxzZTsKCiAgICAgIHZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9OyAvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT4KICAgICAgLy8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZQoKCiAgICAgIHZhciBpc09sZElFID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgL21zaWUgWzYtOV1cYi8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpOwoKICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAocGFyZW50SWQsIGxpc3QsIF9pc1Byb2R1Y3Rpb24pIHsKICAgICAgICBpc1Byb2R1Y3Rpb24gPSBfaXNQcm9kdWN0aW9uOwogICAgICAgIHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMocGFyZW50SWQsIGxpc3QpOwogICAgICAgIGFkZFN0eWxlc1RvRG9tKHN0eWxlcyk7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7CiAgICAgICAgICB2YXIgbWF5UmVtb3ZlID0gW107CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSBzdHlsZXNbaV07CiAgICAgICAgICAgIHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdOwogICAgICAgICAgICBkb21TdHlsZS5yZWZzLS07CiAgICAgICAgICAgIG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobmV3TGlzdCkgewogICAgICAgICAgICBzdHlsZXMgPSBsaXN0VG9TdHlsZXMocGFyZW50SWQsIG5ld0xpc3QpOwogICAgICAgICAgICBhZGRTdHlsZXNUb0RvbShzdHlsZXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3R5bGVzID0gW107CiAgICAgICAgICB9CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXlSZW1vdmUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldOwoKICAgICAgICAgICAgaWYgKGRvbVN0eWxlLnJlZnMgPT09IDApIHsKICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBkb21TdHlsZS5wYXJ0c1tqXSgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH07CgogICAgICBmdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMKICAgICAgLyogQXJyYXk8U3R5bGVPYmplY3Q+ICovCiAgICAgICkgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgaXRlbSA9IHN0eWxlc1tpXTsKICAgICAgICAgIHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdOwoKICAgICAgICAgIGlmIChkb21TdHlsZSkgewogICAgICAgICAgICBkb21TdHlsZS5yZWZzKys7CgogICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZG9tU3R5bGUucGFydHMubGVuZ3RoID4gaXRlbS5wYXJ0cy5sZW5ndGgpIHsKICAgICAgICAgICAgICBkb21TdHlsZS5wYXJ0cy5sZW5ndGggPSBpdGVtLnBhcnRzLmxlbmd0aDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIHBhcnRzID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICBwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0pKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7CiAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgICAgICAgICAgcmVmczogMSwKICAgICAgICAgICAgICBwYXJ0czogcGFydHMKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZVN0eWxlRWxlbWVudCgpIHsKICAgICAgICB2YXIgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICBzdHlsZUVsZW1lbnQudHlwZSA9ICd0ZXh0L2Nzcyc7CiAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpOwogICAgICAgIHJldHVybiBzdHlsZUVsZW1lbnQ7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZFN0eWxlKG9iagogICAgICAvKiBTdHlsZU9iamVjdFBhcnQgKi8KICAgICAgKSB7CiAgICAgICAgdmFyIHVwZGF0ZSwgcmVtb3ZlOwogICAgICAgIHZhciBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzdHlsZVtkYXRhLXZ1ZS1zc3ItaWR+PSInICsgb2JqLmlkICsgJyJdJyk7CgogICAgICAgIGlmIChzdHlsZUVsZW1lbnQpIHsKICAgICAgICAgIGlmIChpc1Byb2R1Y3Rpb24pIHsKICAgICAgICAgICAgLy8gaGFzIFNTUiBzdHlsZXMgYW5kIGluIHByb2R1Y3Rpb24gbW9kZS4KICAgICAgICAgICAgLy8gc2ltcGx5IGRvIG5vdGhpbmcuCiAgICAgICAgICAgIHJldHVybiBub29wOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaGFzIFNTUiBzdHlsZXMgYnV0IGluIGRldiBtb2RlLgogICAgICAgICAgICAvLyBmb3Igc29tZSByZWFzb24gQ2hyb21lIGNhbid0IGhhbmRsZSBzb3VyY2UgbWFwIGluIHNlcnZlci1yZW5kZXJlZAogICAgICAgICAgICAvLyBzdHlsZSB0YWdzIC0gc291cmNlIG1hcHMgaW4gPHN0eWxlPiBvbmx5IHdvcmtzIGlmIHRoZSBzdHlsZSB0YWcgaXMKICAgICAgICAgICAgLy8gY3JlYXRlZCBhbmQgaW5zZXJ0ZWQgZHluYW1pY2FsbHkuIFNvIHdlIHJlbW92ZSB0aGUgc2VydmVyIHJlbmRlcmVkCiAgICAgICAgICAgIC8vIHN0eWxlcyBhbmQgaW5qZWN0IG5ldyBvbmVzLgogICAgICAgICAgICBzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGlzT2xkSUUpIHsKICAgICAgICAgIC8vIHVzZSBzaW5nbGV0b24gbW9kZSBmb3IgSUU5LgogICAgICAgICAgdmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7CiAgICAgICAgICBzdHlsZUVsZW1lbnQgPSBzaW5nbGV0b25FbGVtZW50IHx8IChzaW5nbGV0b25FbGVtZW50ID0gY3JlYXRlU3R5bGVFbGVtZW50KCkpOwogICAgICAgICAgdXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgZmFsc2UpOwogICAgICAgICAgcmVtb3ZlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHVzZSBtdWx0aS1zdHlsZS10YWcgbW9kZSBpbiBhbGwgb3RoZXIgY2FzZXMKICAgICAgICAgIHN0eWxlRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpOwogICAgICAgICAgdXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7CgogICAgICAgICAgcmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgICAgICBzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpOwogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZShvYmopOwogICAgICAgIHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmoKICAgICAgICAvKiBTdHlsZU9iamVjdFBhcnQgKi8KICAgICAgICApIHsKICAgICAgICAgIGlmIChuZXdPYmopIHsKICAgICAgICAgICAgaWYgKG5ld09iai5jc3MgPT09IG9iai5jc3MgJiYgbmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiYgbmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcCkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlKG9iaiA9IG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZW1vdmUoKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICB2YXIgcmVwbGFjZVRleHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHRleHRTdG9yZSA9IFtdOwogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7CiAgICAgICAgICB0ZXh0U3RvcmVbaW5kZXhdID0gcmVwbGFjZW1lbnQ7CiAgICAgICAgICByZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcbicpOwogICAgICAgIH07CiAgICAgIH0oKTsKCiAgICAgIGZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHsKICAgICAgICB2YXIgY3NzID0gcmVtb3ZlID8gJycgOiBvYmouY3NzOwoKICAgICAgICBpZiAoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHsKICAgICAgICAgIHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0LmNzc1RleHQgPSByZXBsYWNlVGV4dChpbmRleCwgY3NzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpOwogICAgICAgICAgdmFyIGNoaWxkTm9kZXMgPSBzdHlsZUVsZW1lbnQuY2hpbGROb2RlczsKICAgICAgICAgIGlmIChjaGlsZE5vZGVzW2luZGV4XSkgc3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTsKCiAgICAgICAgICBpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHsKICAgICAgICAgICAgc3R5bGVFbGVtZW50Lmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlRWxlbWVudCwgb2JqKSB7CiAgICAgICAgdmFyIGNzcyA9IG9iai5jc3M7CiAgICAgICAgdmFyIG1lZGlhID0gb2JqLm1lZGlhOwogICAgICAgIHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwOwoKICAgICAgICBpZiAobWVkaWEpIHsKICAgICAgICAgIHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgbWVkaWEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNvdXJjZU1hcCkgewogICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuY2hyb21lLmNvbS9kZXZ0b29scy9kb2NzL2phdmFzY3JpcHQtZGVidWdnaW5nCiAgICAgICAgICAvLyB0aGlzIG1ha2VzIHNvdXJjZSBtYXBzIGluc2lkZSBzdHlsZSB0YWdzIHdvcmsgcHJvcGVybHkgaW4gQ2hyb21lCiAgICAgICAgICBjc3MgKz0gJ1xuLyojIHNvdXJjZVVSTD0nICsgc291cmNlTWFwLnNvdXJjZXNbMF0gKyAnICovJzsgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjY2MDM4NzUKCiAgICAgICAgICBjc3MgKz0gJ1xuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCwnICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArICcgKi8nOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7CiAgICAgICAgICBzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGlsZSAoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgc3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIC8qKiovCgogICAgfSwKICAgIC8qIDYgKi8KCiAgICAvKioqLwogICAgZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykgewogICAgICAvKioKICAgICAgICogVHJhbnNsYXRlcyB0aGUgbGlzdCBmb3JtYXQgcHJvZHVjZWQgYnkgY3NzLWxvYWRlciBpbnRvIHNvbWV0aGluZwogICAgICAgKiBlYXNpZXIgdG8gbWFuaXB1bGF0ZS4KICAgICAgICovCiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbGlzdFRvU3R5bGVzKHBhcmVudElkLCBsaXN0KSB7CiAgICAgICAgdmFyIHN0eWxlcyA9IFtdOwogICAgICAgIHZhciBuZXdTdHlsZXMgPSB7fTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgaXRlbSA9IGxpc3RbaV07CiAgICAgICAgICB2YXIgaWQgPSBpdGVtWzBdOwogICAgICAgICAgdmFyIGNzcyA9IGl0ZW1bMV07CiAgICAgICAgICB2YXIgbWVkaWEgPSBpdGVtWzJdOwogICAgICAgICAgdmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107CiAgICAgICAgICB2YXIgcGFydCA9IHsKICAgICAgICAgICAgaWQ6IHBhcmVudElkICsgJzonICsgaSwKICAgICAgICAgICAgY3NzOiBjc3MsCiAgICAgICAgICAgIG1lZGlhOiBtZWRpYSwKICAgICAgICAgICAgc291cmNlTWFwOiBzb3VyY2VNYXAKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKCFuZXdTdHlsZXNbaWRdKSB7CiAgICAgICAgICAgIHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7CiAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgIHBhcnRzOiBbcGFydF0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3R5bGVzOwogICAgICB9OwogICAgICAvKioqLwoKICAgIH0sCiAgICAvKiA3ICovCgogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgLy8gdGhpcyBtb2R1bGUgaXMgYSBydW50aW1lIHV0aWxpdHkgZm9yIGNsZWFuZXIgY29tcG9uZW50IG1vZHVsZSBvdXRwdXQgYW5kIHdpbGwKICAgICAgLy8gYmUgaW5jbHVkZWQgaW4gdGhlIGZpbmFsIHdlYnBhY2sgdXNlciBidW5kbGUKICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBub3JtYWxpemVDb21wb25lbnQocmF3U2NyaXB0RXhwb3J0cywgY29tcGlsZWRUZW1wbGF0ZSwgc2NvcGVJZCwgY3NzTW9kdWxlcykgewogICAgICAgIHZhciBlc01vZHVsZTsKICAgICAgICB2YXIgc2NyaXB0RXhwb3J0cyA9IHJhd1NjcmlwdEV4cG9ydHMgPSByYXdTY3JpcHRFeHBvcnRzIHx8IHt9OyAvLyBFUzYgbW9kdWxlcyBpbnRlcm9wCgogICAgICAgIHZhciB0eXBlID0gX3R5cGVvZihyYXdTY3JpcHRFeHBvcnRzLmRlZmF1bHQpOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ29iamVjdCcgfHwgdHlwZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgZXNNb2R1bGUgPSByYXdTY3JpcHRFeHBvcnRzOwogICAgICAgICAgc2NyaXB0RXhwb3J0cyA9IHJhd1NjcmlwdEV4cG9ydHMuZGVmYXVsdDsKICAgICAgICB9IC8vIFZ1ZS5leHRlbmQgY29uc3RydWN0b3IgZXhwb3J0IGludGVyb3AKCgogICAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIHNjcmlwdEV4cG9ydHMgPT09ICdmdW5jdGlvbicgPyBzY3JpcHRFeHBvcnRzLm9wdGlvbnMgOiBzY3JpcHRFeHBvcnRzOyAvLyByZW5kZXIgZnVuY3Rpb25zCgogICAgICAgIGlmIChjb21waWxlZFRlbXBsYXRlKSB7CiAgICAgICAgICBvcHRpb25zLnJlbmRlciA9IGNvbXBpbGVkVGVtcGxhdGUucmVuZGVyOwogICAgICAgICAgb3B0aW9ucy5zdGF0aWNSZW5kZXJGbnMgPSBjb21waWxlZFRlbXBsYXRlLnN0YXRpY1JlbmRlckZuczsKICAgICAgICB9IC8vIHNjb3BlZElkCgoKICAgICAgICBpZiAoc2NvcGVJZCkgewogICAgICAgICAgb3B0aW9ucy5fc2NvcGVJZCA9IHNjb3BlSWQ7CiAgICAgICAgfSAvLyBpbmplY3QgY3NzTW9kdWxlcwoKCiAgICAgICAgaWYgKGNzc01vZHVsZXMpIHsKICAgICAgICAgIHZhciBjb21wdXRlZCA9IE9iamVjdC5jcmVhdGUob3B0aW9ucy5jb21wdXRlZCB8fCBudWxsKTsKICAgICAgICAgIE9iamVjdC5rZXlzKGNzc01vZHVsZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICB2YXIgbW9kdWxlID0gY3NzTW9kdWxlc1trZXldOwoKICAgICAgICAgICAgY29tcHV0ZWRba2V5XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlOwogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICBvcHRpb25zLmNvbXB1dGVkID0gY29tcHV0ZWQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgZXNNb2R1bGU6IGVzTW9kdWxlLAogICAgICAgICAgZXhwb3J0czogc2NyaXB0RXhwb3J0cywKICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnMKICAgICAgICB9OwogICAgICB9OwogICAgICAvKioqLwoKICAgIH0sCiAgICAvKiA4ICovCgogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogICAgICAgIHZhbHVlOiB0cnVlCiAgICAgIH0pOwoKICAgICAgdmFyIF92dWVQcm9ncmVzcyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CgogICAgICB2YXIgX3Z1ZVByb2dyZXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Z1ZVByb2dyZXNzKTsKCiAgICAgIGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgICAgICAgIGRlZmF1bHQ6IG9iagogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGV4cG9ydHMuZGVmYXVsdCA9IHsKICAgICAgICBuYW1lOiAnc3ZnLXByb2dyZXNzLWJhcicsCiAgICAgICAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHZ1ZVByb2dyZXNzOiBudWxsCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgdHlwZTogT2JqZWN0LAogICAgICAgICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICAgICAgICByZXR1cm4ge307CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB2YWx1ZTogewogICAgICAgICAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddCiAgICAgICAgICB9LAogICAgICAgICAgaXRlbTogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgICAgICAgIHJldHVybiB7fTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHR5cGU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nCiAgICAgICAgICB9LAogICAgICAgICAgdmFsQWRkQ2FsQmFjazogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjb21wdXRlZDoge30sCiAgICAgICAgY29tcG9uZW50czoge30sCiAgICAgICAgbWV0aG9kczogewogICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUodmFsLCBkdXJhdGlvbikgewogICAgICAgICAgICB0aGlzLnZ1ZVByb2dyZXNzLnVwZGF0ZSh2YWwsIGR1cmF0aW9uKTsKICAgICAgICAgIH0sCiAgICAgICAgICBnZXRWYWw6IGZ1bmN0aW9uIGdldFZhbCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMudnVlUHJvZ3Jlc3MuZ2V0VmFsdWUoKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHdhdGNoOiB7CiAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodmFsMSwgdmFsMikgewogICAgICAgICAgICB0aGlzLnVwZGF0ZSh2YWwxLCBNYXRoLmFicyh2YWwxIC0gdmFsMikgKiAxMik7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICAgICAgdGhpcy52dWVQcm9ncmVzcyA9IF92dWVQcm9ncmVzczIuZGVmYXVsdC5jcmVhdGUoewogICAgICAgICAgICBkb206IHRoaXMuJHJlZnMucHJvZ3Jlc3MsCiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSwKICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWUsCiAgICAgICAgICAgIGl0ZW06IHRoaXMuaXRlbSwKICAgICAgICAgICAgdmFsUmF0ZTogdGhpcy5vcHRpb25zLnZhbFJhdGUsCiAgICAgICAgICAgIHJhZGl1czogdGhpcy5vcHRpb25zLnJhZGl1cywKICAgICAgICAgICAgY2lyY2xlV2lkdGg6IHRoaXMub3B0aW9ucy5jaXJjbGVXaWR0aCwKICAgICAgICAgICAgdmFyeVN0cm9rZUFycmF5OiB0aGlzLm9wdGlvbnMudmFyeVN0cm9rZUFycmF5LAogICAgICAgICAgICBjaXJjbGVMaW5lQ2FwOiB0aGlzLm9wdGlvbnMuY2lyY2xlTGluZUNhcCwKICAgICAgICAgICAgbWF4VmFsdWU6IHRoaXMub3B0aW9ucy5tYXhWYWx1ZSwKICAgICAgICAgICAgdGV4dDogdGhpcy5vcHRpb25zLnRleHQsCiAgICAgICAgICAgIHRleHRDb2xvcjogdGhpcy5vcHRpb25zLnRleHRDb2xvciwKICAgICAgICAgICAgcGF0aENvbG9yczogdGhpcy5vcHRpb25zLnBhdGhDb2xvcnMsCiAgICAgICAgICAgIGdyYWRpZW50Q29sb3I6IHRoaXMub3B0aW9ucy5ncmFkaWVudENvbG9yLAogICAgICAgICAgICBncmFkaWVudE9wYWNpdHk6IHRoaXMub3B0aW9ucy5ncmFkaWVudE9wYWNpdHksCiAgICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMuZHVyYXRpb24sCiAgICAgICAgICAgIHJlY3RXaWR0aDogdGhpcy5vcHRpb25zLnJlY3RXaWR0aCwKICAgICAgICAgICAgcmVjdEhlaWdodDogdGhpcy5vcHRpb25zLnJlY3RIZWlnaHQsCiAgICAgICAgICAgIHJlY3RSYWRpdXM6IHRoaXMub3B0aW9ucy5yZWN0UmFkaXVzLAogICAgICAgICAgICB2YWxBZGRDYWxCYWNrOiB0aGlzLnZhbEFkZENhbEJhY2sKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgLyoqKi8KICAgIH0sCiAgICAvKiA5ICovCgogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogICAgICAgIHZhbHVlOiB0cnVlCiAgICAgIH0pOwoKICAgICAgdmFyIHJlcXVlc3RBbmltRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTsKICAgICAgfSwKICAgICAgICAgIHZ1ZVByb2dyZXNzID0gZnVuY3Rpb24gdnVlUHJvZ3Jlc3Mob3B0aW9ucykgewogICAgICAgIHZhciBlbmRBbmdsZVJhZCA9IE1hdGguUEkgLyAxODAgKiAyNzA7CiAgICAgICAgdGhpcy5fZWwgPSBvcHRpb25zLmRvbTsKICAgICAgICB0aGlzLl90eXBlID0gb3B0aW9ucy50eXBlIHx8ICdjaXJjbGUnOwogICAgICAgIHRoaXMuX3ZhbFJhdGUgPSBvcHRpb25zLnZhbFJhdGUgfHwgMTsKICAgICAgICB0aGlzLl9yZWN0V2lkdGggPSBvcHRpb25zLnJlY3RXaWR0aCB8fCAyMDA7CiAgICAgICAgdGhpcy5fcmVjdEhlaWdodCA9IG9wdGlvbnMucmVjdEhlaWdodCB8fCAyMDsKICAgICAgICB0aGlzLl9yZWN0UmFkaXVzID0gb3B0aW9ucy5yZWN0UmFkaXVzIHx8IDA7CiAgICAgICAgdGhpcy5fcmFkaXVzID0gb3B0aW9ucy5yYWRpdXMgfHwgNTA7CiAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBvcHRpb25zLmR1cmF0aW9uID09PSB1bmRlZmluZWQgPyA1MDAgOiBvcHRpb25zLmR1cmF0aW9uOwogICAgICAgIHRoaXMuX21heFZhbHVlID0gb3B0aW9ucy5tYXhWYWx1ZSB8fCAxMDA7CiAgICAgICAgdGhpcy5fdmFsQWRkQ2FsQmFjayA9IG9wdGlvbnMudmFsQWRkQ2FsQmFjazsKICAgICAgICB0aGlzLl90ZXh0ID0gb3B0aW9ucy50ZXh0ID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmh0bWxpZnlOdW1iZXIodmFsdWUpOwogICAgICAgIH0gOiBvcHRpb25zLnRleHQ7CiAgICAgICAgdGhpcy5fc3Ryb2tlV2lkdGggPSBvcHRpb25zLmNpcmNsZVdpZHRoIHx8IDEwOwogICAgICAgIHRoaXMuX3N0cm9rZVdpZHRoQXJyYXkgPSBvcHRpb25zLnZhcnlTdHJva2VBcnJheTsKICAgICAgICB0aGlzLl9jaXJjbGVMaW5lQ2FwID0gb3B0aW9ucy5jaXJjbGVMaW5lQ2FwOwogICAgICAgIHRoaXMuX2NvbG9ycyA9IG9wdGlvbnMucGF0aENvbG9ycyB8fCBbJyNFRUUnLCAnI0YwMCddOwogICAgICAgIHRoaXMuX2dyYWRpZW50Q29sb3IgPSBvcHRpb25zLmdyYWRpZW50Q29sb3I7CiAgICAgICAgdGhpcy5fZ3JhZGllbnRPcGFjaXR5ID0gb3B0aW9ucy5ncmFkaWVudE9wYWNpdHkgfHwgWzEsIDFdOwogICAgICAgIHRoaXMuX3RleHRDb2xvciA9IG9wdGlvbnMudGV4dENvbG9yIHx8ICcjMDAwJzsKICAgICAgICB0aGlzLl92YWx1ZSA9IDA7CiAgICAgICAgdGhpcy5fc3ZnID0gbnVsbDsKICAgICAgICB0aGlzLl9pdGVtID0gb3B0aW9ucy5pdGVtIHx8IHt9OwogICAgICAgIHRoaXMuX21vdmluZ1BhdGggPSBudWxsOwogICAgICAgIHRoaXMuX3dyYXBDb250YWluZXIgPSBudWxsOwogICAgICAgIHRoaXMuX3RleHRDb250YWluZXIgPSBudWxsOwogICAgICAgIHRoaXMuX3dycENsYXNzID0gb3B0aW9ucy53cmFwQ2xhc3MgfHwgJ2NpcmNsZXMtd3JhcCc7CiAgICAgICAgdGhpcy5fdGV4dENsYXNzID0gb3B0aW9ucy50ZXh0Q2xhc3MgfHwgJ2NpcmNsZXMtdGV4dCc7CiAgICAgICAgdGhpcy5fdmFsQ2xhc3MgPSBvcHRpb25zLnZhbHVlU3Ryb2tlQ2xhc3MgfHwgJ2NpcmNsZXMtdmFsdWVTdHJva2UnOwogICAgICAgIHRoaXMuX21heFZhbENsYXNzID0gb3B0aW9ucy5tYXhWYWx1ZVN0cm9rZUNsYXNzIHx8ICdjaXJjbGVzLW1heFZhbHVlU3Ryb2tlJzsKICAgICAgICB0aGlzLl9zdHlsZVdyYXBwZXIgPSBvcHRpb25zLnN0eWxlV3JhcHBlciA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgdGhpcy5fc3R5bGVUZXh0ID0gb3B0aW9ucy5zdHlsZVRleHQgPT09IGZhbHNlID8gZmFsc2UgOiB0cnVlOwogICAgICAgIHRoaXMuX3N0YXJ0ID0gLU1hdGguUEkgLyAxODAgKiA5MDsKICAgICAgICB0aGlzLl9zdGFydFByZWNpc2UgPSB0aGlzLl9wcmVjaXNlKHRoaXMuX3N0YXJ0KTsKICAgICAgICB0aGlzLl9jaXJjID0gZW5kQW5nbGVSYWQgLSB0aGlzLl9zdGFydDsKICAgICAgICB0aGlzLl9OU19TVkcgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnOwogICAgICAgIHRoaXMuX2xhc3RWYWwgPSBvcHRpb25zLnZhbHVlOwoKICAgICAgICB0aGlzLl9nZW5lcmF0ZSgpLnVwZGF0ZSh0aGlzLl9sYXN0VmFsIHx8IDApOwogICAgICB9OwoKICAgICAgdnVlUHJvZ3Jlc3MucHJvdG90eXBlID0gewogICAgICAgIF9nZW5lcmF0ZTogZnVuY3Rpb24gX2dlbmVyYXRlKCkgewogICAgICAgICAgdGhpcy5fc3ZnU2l6ZSA9IHRoaXMuX3JhZGl1cyAqIDI7CiAgICAgICAgICB0aGlzLl9yYWRpdXNBZGp1c3RlZCA9IHRoaXMuX3JhZGl1cyAtICh0aGlzLl9zdHJva2VXaWR0aEFycmF5ID8gTWF0aC5tYXgodGhpcy5fc3Ryb2tlV2lkdGhBcnJheVswXSwgdGhpcy5fc3Ryb2tlV2lkdGhBcnJheVsxXSkgLyAyIDogdGhpcy5fc3Ryb2tlV2lkdGggLyAyKTsKCiAgICAgICAgICB0aGlzLl9nZW5lcmF0ZVN2ZygpLl9nZW5lcmF0ZVRleHQoKS5fZ2VuZXJhdGVXcmFwcGVyKCk7CgogICAgICAgICAgdGhpcy5fZWwuaW5uZXJIVE1MID0gJyc7CgogICAgICAgICAgdGhpcy5fZWwuYXBwZW5kQ2hpbGQodGhpcy5fd3JhcENvbnRhaW5lcik7CgogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICBfc2V0Q3NzOiBmdW5jdGlvbiBfc2V0Q3NzKGRvbSwgY3NzRGF0YSkgewogICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBjc3NEYXRhKSB7CiAgICAgICAgICAgIGRvbS5zdHlsZVtwcm9wXSA9IGNzc0RhdGFbcHJvcF07CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBfc2V0UGVyY2VudGFnZTogZnVuY3Rpb24gX3NldFBlcmNlbnRhZ2UocGVyY2VudGFnZSkgewogICAgICAgICAgaWYgKHRoaXMuX3R5cGUgPT09ICdjaXJjbGUnKSB7CiAgICAgICAgICAgIHRoaXMuX21vdmluZ1BhdGguc2V0QXR0cmlidXRlKCdkJywgdGhpcy5fY2FsY3VsYXRlUGF0aChwZXJjZW50YWdlLCB0cnVlKSk7CgogICAgICAgICAgICB0aGlzLl9zZXRDc3ModGhpcy5fbW92aW5nUGF0aCwgewogICAgICAgICAgICAgIGRpc3BsYXk6IHBlcmNlbnRhZ2UgPD0gMCA/ICdub25lJyA6ICdpbmxpbmUnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90eXBlID09PSAncmVjdCcpIHsKICAgICAgICAgICAgdGhpcy5fbW92aW5nUGF0aC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy5fcmVjdFdpZHRoICogcGVyY2VudGFnZSAvIDEwMCk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5fdGV4dENvbnRhaW5lci5pbm5lckhUTUwgPSB0aGlzLl9nZXRUZXh0KHRoaXMuZ2V0VmFsdWVGcm9tUGVyY2VudChwZXJjZW50YWdlKSwgdGhpcy5faXRlbSk7CiAgICAgICAgfSwKICAgICAgICBfZ2VuZXJhdGVXcmFwcGVyOiBmdW5jdGlvbiBfZ2VuZXJhdGVXcmFwcGVyKCkgewogICAgICAgICAgdGhpcy5fd3JhcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgdGhpcy5fd3JhcENvbnRhaW5lci5jbGFzc05hbWUgPSB0aGlzLl93cnBDbGFzczsKCiAgICAgICAgICBpZiAodGhpcy5fc3R5bGVXcmFwcGVyKSB7CiAgICAgICAgICAgIHRoaXMuX3dyYXBDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOwogICAgICAgICAgICB0aGlzLl93cmFwQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuX2l0ZW0uc3RhdHVzID09PSAnbm9ybWFsJykgewogICAgICAgICAgICB0aGlzLl93cmFwQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnY29sb3JfYm9yZGVyJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLl93cmFwQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnd2hpdGVfYm9yZGVyJyk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5fd3JhcENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLl9zdmcpOwoKICAgICAgICAgIHRoaXMuX3dyYXBDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5fdGV4dENvbnRhaW5lcik7CgogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICBfZ2VuZXJhdGVUZXh0OiBmdW5jdGlvbiBfZ2VuZXJhdGVUZXh0KCkgewogICAgICAgICAgdGhpcy5fdGV4dENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgdGhpcy5fdGV4dENvbnRhaW5lci5jbGFzc05hbWUgPSB0aGlzLl90ZXh0Q2xhc3M7CgogICAgICAgICAgaWYgKHRoaXMuX3N0eWxlVGV4dCkgewogICAgICAgICAgICB2YXIgc3R5bGUgPSB7CiAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsCiAgICAgICAgICAgICAgdG9wOiAwLAogICAgICAgICAgICAgIGxlZnQ6IDAsCiAgICAgICAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnLAogICAgICAgICAgICAgIC8vIGZvbnRTaXplOiB0aGlzLl9yYWRpdXMgKiAwLjYgKyAncHgnLAogICAgICAgICAgICAgIGhlaWdodDogdGhpcy5fc3ZnU2l6ZSArICdweCcsCiAgICAgICAgICAgICAgLy8gbGluZUhlaWdodDogdGhpcy5fc3ZnU2l6ZSArICdweCcsCiAgICAgICAgICAgICAgY29sb3I6IHRoaXMuX3RleHRDb2xvcgogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdGhpcy5fc2V0Q3NzKHRoaXMuX3RleHRDb250YWluZXIsIHN0eWxlKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl90ZXh0Q29udGFpbmVyLmlubmVySFRNTCA9IHRoaXMuX2dldFRleHQoMCwgdGhpcy5faXRlbSk7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIF9nZXRUZXh0OiBmdW5jdGlvbiBfZ2V0VGV4dCh2YWx1ZSwgaXRlbSkgewogICAgICAgICAgaWYgKCF0aGlzLl90ZXh0KSByZXR1cm4gJyc7CiAgICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSB0aGlzLl92YWx1ZTsKICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZS50b0ZpeGVkKDIpKTsKICAgICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5fdGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMuX3RleHQuY2FsbCh0aGlzLCB2YWx1ZSwgaXRlbSkgOiB0aGlzLl90ZXh0OwogICAgICAgIH0sCiAgICAgICAgX2dlbmVyYXRlU3ZnOiBmdW5jdGlvbiBfZ2VuZXJhdGVTdmcoKSB7CiAgICAgICAgICB0aGlzLl9zdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy5fTlNfU1ZHLCAnc3ZnJyk7CgogICAgICAgICAgdGhpcy5fc3ZnLnNldEF0dHJpYnV0ZSgneG1sbnMnLCB0aGlzLl9OU19TVkcpOwoKICAgICAgICAgIHRoaXMuX2dlbmVyYXRlUGF0aCgxMDAsIGZhbHNlLCB0aGlzLl9jb2xvcnNbMF0sIHRoaXMuX21heFZhbENsYXNzKS5fZ2VuZXJhdGVQYXRoKDAsIHRydWUsIHRoaXMuX2l0ZW0uc3RhdHVzID09PSAnbm9ybWFsJyA/IHRoaXMuX2NvbG9yc1sxXSA6ICd3aGl0ZScsIHRoaXMuX3ZhbENsYXNzKTsKCiAgICAgICAgICBpZiAodGhpcy5fdHlwZSA9PT0gJ2NpcmNsZScpIHsKICAgICAgICAgICAgdGhpcy5fc3ZnV2lkdGggPSB0aGlzLl9zdmdIZWlnaHQgPSB0aGlzLl9zdmdTaXplOwogICAgICAgICAgICB0aGlzLl9tb3ZpbmdQYXRoID0gdGhpcy5fc3ZnLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdwYXRoJylbMV07CgogICAgICAgICAgICB0aGlzLl9zdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLl9zdmdIZWlnaHQpOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90eXBlID09PSAncmVjdCcpIHsKICAgICAgICAgICAgdGhpcy5fc3ZnV2lkdGggPSB0aGlzLl9yZWN0V2lkdGg7CiAgICAgICAgICAgIHRoaXMuX3N2Z1NpemUgPSB0aGlzLl9zdmdIZWlnaHQgPSB0aGlzLl9yZWN0SGVpZ2h0OwogICAgICAgICAgICB0aGlzLl9tb3ZpbmdQYXRoID0gdGhpcy5fc3ZnLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdyZWN0JylbMV07CgogICAgICAgICAgICB0aGlzLl9zdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLl9zdHJva2VXaWR0aEFycmF5ID8gTWF0aC5tYXgodGhpcy5fc3Ryb2tlV2lkdGhBcnJheVswXSwgdGhpcy5fc3Ryb2tlV2lkdGhBcnJheVsxXSkgOiB0aGlzLl9zdmdIZWlnaHQpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuX3N2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy5fc3ZnV2lkdGgpOwoKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAgICAgICAgX2dlbmVyYXRlUGF0aDogZnVuY3Rpb24gX2dlbmVyYXRlUGF0aChwZXJjZW50YWdlLCBvcGVuLCBjb2xvciwgcGF0aENsYXNzKSB7CiAgICAgICAgICB2YXIgcGF0aCA9IHZvaWQgMCwKICAgICAgICAgICAgICBub3cgPSArbmV3IERhdGUoKTsKCiAgICAgICAgICBpZiAodGhpcy5fZ3JhZGllbnRDb2xvciAmJiBvcGVuICYmIHRoaXMuX3R5cGUgPT09ICdyZWN0JykgewogICAgICAgICAgICB2YXIgZGVmcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyh0aGlzLl9OU19TVkcsICdkZWZzJyk7CiAgICAgICAgICAgIHZhciBsaW5lYXJHcmFkaWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyh0aGlzLl9OU19TVkcsICdsaW5lYXJHcmFkaWVudCcpOwogICAgICAgICAgICBsaW5lYXJHcmFkaWVudC5pZCA9IG5vdzsKICAgICAgICAgICAgdmFyIHN0b3AxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHRoaXMuX05TX1NWRywgJ3N0b3AnKTsKICAgICAgICAgICAgc3RvcDEuc2V0QXR0cmlidXRlKCdvZmZzZXQnLCAnMCUnKTsKICAgICAgICAgICAgc3RvcDEuc2V0QXR0cmlidXRlKCdzdG9wLWNvbG9yJywgdGhpcy5fZ3JhZGllbnRDb2xvclswXSk7CiAgICAgICAgICAgIHN0b3AxLnNldEF0dHJpYnV0ZSgnc3RvcC1vcGFjaXR5JywgdGhpcy5fZ3JhZGllbnRPcGFjaXR5WzBdKTsKICAgICAgICAgICAgdmFyIHN0b3AyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHRoaXMuX05TX1NWRywgJ3N0b3AnKTsKICAgICAgICAgICAgc3RvcDIuc2V0QXR0cmlidXRlKCdvZmZzZXQnLCAnMTAwJScpOwogICAgICAgICAgICBzdG9wMi5zZXRBdHRyaWJ1dGUoJ3N0b3AtY29sb3InLCB0aGlzLl9ncmFkaWVudENvbG9yWzFdKTsKICAgICAgICAgICAgc3RvcDIuc2V0QXR0cmlidXRlKCdzdG9wLW9wYWNpdHknLCB0aGlzLl9ncmFkaWVudE9wYWNpdHlbMV0pOwogICAgICAgICAgICBsaW5lYXJHcmFkaWVudC5hcHBlbmRDaGlsZChzdG9wMSk7CiAgICAgICAgICAgIGxpbmVhckdyYWRpZW50LmFwcGVuZENoaWxkKHN0b3AyKTsKICAgICAgICAgICAgZGVmcy5hcHBlbmRDaGlsZChsaW5lYXJHcmFkaWVudCk7CgogICAgICAgICAgICB0aGlzLl9zdmcuYXBwZW5kQ2hpbGQoZGVmcyk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuX3R5cGUgPT09ICdjaXJjbGUnKSB7CiAgICAgICAgICAgIHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy5fTlNfU1ZHLCAncGF0aCcpOwoKICAgICAgICAgICAgdGhpcy5fc2V0Q3NzKHBhdGgsIHsKICAgICAgICAgICAgICBmaWxsOiAndHJhbnNwYXJlbnQnLAogICAgICAgICAgICAgIHN0cm9rZTogY29sb3IsCiAgICAgICAgICAgICAgZGlzcGxheTogdGhpcy5fbGFzdFZhbCA8PSAwICYmIG9wZW4gPyAnbm9uZScgOiAnaW5saW5lJywKICAgICAgICAgICAgICAnc3Ryb2tlLXdpZHRoJzogdGhpcy5fc3Ryb2tlV2lkdGhBcnJheSA/IG9wZW4gPyB0aGlzLl9zdHJva2VXaWR0aEFycmF5WzFdIDogdGhpcy5fc3Ryb2tlV2lkdGhBcnJheVswXSA6IHRoaXMuX3N0cm9rZVdpZHRoCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCB0aGlzLl9jYWxjdWxhdGVQYXRoKHBlcmNlbnRhZ2UsIG9wZW4pKTsKICAgICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgcGF0aENsYXNzKTsKICAgICAgICAgICAgdGhpcy5fY2lyY2xlTGluZUNhcCAmJiBwYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCB0aGlzLl9jaXJjbGVMaW5lQ2FwKTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fdHlwZSA9PT0gJ3JlY3QnKSB7CiAgICAgICAgICAgIHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy5fTlNfU1ZHLCAncmVjdCcpOwogICAgICAgICAgICB2YXIgcmVjdFN0eWxlID0gewogICAgICAgICAgICAgIGZpbGw6IHRoaXMuX2dyYWRpZW50Q29sb3IgJiYgb3BlbiA/ICd1cmwoIycgKyBub3cgKyAnKScgOiBjb2xvcgogICAgICAgICAgICB9OwogICAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgncngnLCB0aGlzLl9yZWN0UmFkaXVzKTsKICAgICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3J5JywgdGhpcy5fcmVjdFJhZGl1cyk7CgogICAgICAgICAgICBpZiAodGhpcy5fc3Ryb2tlV2lkdGhBcnJheSkgewogICAgICAgICAgICAgIHZhciBkZWxhdGVkID0gKHRoaXMuX3N0cm9rZVdpZHRoQXJyYXlbMV0gLSB0aGlzLl9zdHJva2VXaWR0aEFycmF5WzBdKSAvIDI7CgogICAgICAgICAgICAgIGlmIChkZWxhdGVkID4gMCkgewogICAgICAgICAgICAgICAgIW9wZW4gJiYgcGF0aC5zZXRBdHRyaWJ1dGUoJ3knLCBkZWxhdGVkKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgb3BlbiAmJiBwYXRoLnNldEF0dHJpYnV0ZSgneScsIC1kZWxhdGVkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCd3aWR0aCcsIHRoaXMuX3JlY3RXaWR0aCAqIHBlcmNlbnRhZ2UgLyAxMDApOwogICAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgdGhpcy5fc3Ryb2tlV2lkdGhBcnJheSA/IG9wZW4gPyB0aGlzLl9zdHJva2VXaWR0aEFycmF5WzFdIDogdGhpcy5fc3Ryb2tlV2lkdGhBcnJheVswXSA6IHRoaXMuX3JlY3RIZWlnaHQpOwoKICAgICAgICAgICAgdGhpcy5fc2V0Q3NzKHBhdGgsIHJlY3RTdHlsZSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5fc3ZnLmFwcGVuZENoaWxkKHBhdGgpOwoKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0sCiAgICAgICAgX2NhbGN1bGF0ZVBhdGg6IGZ1bmN0aW9uIF9jYWxjdWxhdGVQYXRoKHBlcmNlbnRhZ2UsIG9wZW4pIHsKICAgICAgICAgIHZhciBlbmQgPSB0aGlzLl9zdGFydCArIHBlcmNlbnRhZ2UgLyAxMDAgKiB0aGlzLl9jaXJjLAogICAgICAgICAgICAgIGVuZFByZWNpc2UgPSB0aGlzLl9wcmVjaXNlKGVuZCk7CgogICAgICAgICAgcmV0dXJuIHRoaXMuX2FyYyhlbmRQcmVjaXNlLCBvcGVuLCBwZXJjZW50YWdlKTsKICAgICAgICB9LAogICAgICAgIF9hcmM6IGZ1bmN0aW9uIF9hcmMoZW5kLCBvcGVuLCBwZXJjZW50YWdlKSB7CiAgICAgICAgICB2YXIgZW5kQWRqdXN0ZWQgPSBlbmQgLSAwLjAwMSwKICAgICAgICAgICAgICBsb25nQXJjID0gZW5kIC0gdGhpcy5fc3RhcnRQcmVjaXNlIDwgTWF0aC5QSSA/IDAgOiAxOwogICAgICAgICAgcmV0dXJuIFsnTScsIHRoaXMuX3JhZGl1cyArIHRoaXMuX3JhZGl1c0FkanVzdGVkICogTWF0aC5jb3ModGhpcy5fc3RhcnRQcmVjaXNlKSwgdGhpcy5fcmFkaXVzICsgdGhpcy5fcmFkaXVzQWRqdXN0ZWQgKiBNYXRoLnNpbih0aGlzLl9zdGFydFByZWNpc2UpLCAnQScsIHRoaXMuX3JhZGl1c0FkanVzdGVkLCB0aGlzLl9yYWRpdXNBZGp1c3RlZCwgMCwgbG9uZ0FyYywgMSwgdGhpcy5fcmFkaXVzICsgdGhpcy5fcmFkaXVzQWRqdXN0ZWQgKiBNYXRoLmNvcyhlbmRBZGp1c3RlZCksIHRoaXMuX3JhZGl1cyArIHRoaXMuX3JhZGl1c0FkanVzdGVkICogTWF0aC5zaW4oZW5kQWRqdXN0ZWQpLCBvcGVuICYmIHBlcmNlbnRhZ2UgPCAxMDAgPyAnJyA6ICdaJ10uam9pbignICcpOwogICAgICAgIH0sCiAgICAgICAgX3ByZWNpc2U6IGZ1bmN0aW9uIF9wcmVjaXNlKHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSAqIDEwMDApIC8gMTAwMDsKICAgICAgICB9LAogICAgICAgIGh0bWxpZnlOdW1iZXI6IGZ1bmN0aW9uIGh0bWxpZnlOdW1iZXIobnVtYmVyLCBpbnRlZ2VyUGFydENsYXNzLCBkZWNpbWFsUGFydENsYXNzKSB7CiAgICAgICAgICBpbnRlZ2VyUGFydENsYXNzID0gaW50ZWdlclBhcnRDbGFzcyB8fCAnY2lyY2xlcy1pbnRlZ2VyJzsKICAgICAgICAgIGRlY2ltYWxQYXJ0Q2xhc3MgPSBkZWNpbWFsUGFydENsYXNzIHx8ICdjaXJjbGVzLWRlY2ltYWxzJzsKICAgICAgICAgIHZhciBwYXJ0cyA9IChudW1iZXIgKyAnJykuc3BsaXQoJy4nKSwKICAgICAgICAgICAgICBodG1sID0gJzxzcGFuIGNsYXNzPSInICsgaW50ZWdlclBhcnRDbGFzcyArICciPicgKyBwYXJ0c1swXSArICc8L3NwYW4+JzsKCiAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICBodG1sICs9ICcuPHNwYW4gY2xhc3M9IicgKyBkZWNpbWFsUGFydENsYXNzICsgJyIgc3R5bGU9ImZvbnQtc2l6ZTogMC40NWVtIj4nICsgcGFydHNbMV0uc3Vic3RyaW5nKDAsIDIpICsgJzwvc3Bhbj4nOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBodG1sOwogICAgICAgIH0sCiAgICAgICAgZ2V0UGVyY2VudDogZnVuY3Rpb24gZ2V0UGVyY2VudCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZSAqIDEwMCAvIHRoaXMuX21heFZhbHVlOwogICAgICAgIH0sCiAgICAgICAgZ2V0VmFsdWVGcm9tUGVyY2VudDogZnVuY3Rpb24gZ2V0VmFsdWVGcm9tUGVyY2VudChwZXJjZW50YWdlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fbWF4VmFsdWUgKiBwZXJjZW50YWdlIC8gMTAwOwogICAgICAgIH0sCiAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUodmFsdWUpIHsKICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMuX2R1cmF0aW9uOwogICAgICAgICAgaWYgKHRoaXMuX3ZhbHVlID09IHZhbHVlIHx8IGlzTmFOKHZhbHVlKSkgcmV0dXJuIHRoaXM7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgICAgICAgb2xkUGVyY2VudGFnZSA9IHNlbGYuZ2V0UGVyY2VudCgpLAogICAgICAgICAgICAgIGRlbHRhID0gdGhpcy5fdmFsUmF0ZSwKICAgICAgICAgICAgICBuZXdQZXJjZW50YWdlID0gdm9pZCAwLAogICAgICAgICAgICAgIGlzR3JlYXRlciA9IHZvaWQgMCwKICAgICAgICAgICAgICBzdGVwcyA9IHZvaWQgMCwKICAgICAgICAgICAgICBzdGVwRHVyYXRpb24gPSB2b2lkIDA7CiAgICAgICAgICB0aGlzLl92YWx1ZSA9IE1hdGgubWluKHRoaXMuX21heFZhbHVlLCBNYXRoLm1heCgwLCB2YWx1ZSkpOwogICAgICAgICAgbmV3UGVyY2VudGFnZSA9IHNlbGYuZ2V0UGVyY2VudCgpOwogICAgICAgICAgaXNHcmVhdGVyID0gbmV3UGVyY2VudGFnZSA+IG9sZFBlcmNlbnRhZ2U7CiAgICAgICAgICBkZWx0YSArPSBuZXdQZXJjZW50YWdlICUgMTsKICAgICAgICAgIHN0ZXBzID0gTWF0aC5mbG9vcihNYXRoLmFicyhuZXdQZXJjZW50YWdlIC0gb2xkUGVyY2VudGFnZSkgLyBkZWx0YSk7CiAgICAgICAgICBzdGVwRHVyYXRpb24gPSBkdXJhdGlvbiAvIHN0ZXBzOwoKICAgICAgICAgIChmdW5jdGlvbiBhbmltYXRlKGxhc3RGcmFtZSkgewogICAgICAgICAgICBpZiAoaXNHcmVhdGVyKSB7CiAgICAgICAgICAgICAgb2xkUGVyY2VudGFnZSArPSBkZWx0YTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBvbGRQZXJjZW50YWdlIC09IGRlbHRhOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIganVkZ2VSYXRlID0gc2VsZi5fdmFsUmF0ZSA+IGRlbHRhID8gc2VsZi5fdmFsUmF0ZSA6IGRlbHRhOwoKICAgICAgICAgICAgaWYgKHNlbGYuX3ZhbEFkZENhbEJhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHNlbGYuX3ZhbEFkZENhbEJhY2suZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgaWYgKGl0ZW0udmFsdWUgLSBvbGRQZXJjZW50YWdlID4gMCAmJiBpdGVtLnZhbHVlIC0gb2xkUGVyY2VudGFnZSA8PSBqdWRnZVJhdGUpIHsKICAgICAgICAgICAgICAgICAgaXRlbS5mdW5jKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChpc0dyZWF0ZXIgJiYgb2xkUGVyY2VudGFnZSA+PSBuZXdQZXJjZW50YWdlIHx8ICFpc0dyZWF0ZXIgJiYgb2xkUGVyY2VudGFnZSA8PSBuZXdQZXJjZW50YWdlKSB7CiAgICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRQZXJjZW50YWdlKG5ld1BlcmNlbnRhZ2UpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgc2VsZi5fc2V0UGVyY2VudGFnZShvbGRQZXJjZW50YWdlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgZGVsdGFUaW1lID0gbm93IC0gbGFzdEZyYW1lOwoKICAgICAgICAgICAgaWYgKGRlbHRhVGltZSA+PSBzdGVwRHVyYXRpb24pIHsKICAgICAgICAgICAgICBhbmltYXRlKG5vdyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBhbmltYXRlKERhdGUubm93KCkpOwogICAgICAgICAgICAgIH0sIHN0ZXBEdXJhdGlvbiAtIGRlbHRhVGltZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKERhdGUubm93KCkpOwoKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHZ1ZVByb2dyZXNzLmNyZWF0ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgcmV0dXJuIG5ldyB2dWVQcm9ncmVzcyhvcHRpb25zKTsKICAgICAgfTsKCiAgICAgIGV4cG9ydHMuZGVmYXVsdCA9IHZ1ZVByb2dyZXNzOwogICAgICAvKioqLwogICAgfSwKICAgIC8qIDEwICovCgogICAgLyoqKi8KICAgIGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgbW9kdWxlLmV4cG9ydHMgPSB7CiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgICAgICB2YXIgX3ZtID0gdGhpczsKCiAgICAgICAgICB2YXIgX2ggPSBfdm0uJGNyZWF0ZUVsZW1lbnQ7CgogICAgICAgICAgdmFyIF9jID0gX3ZtLl9zZWxmLl9jIHx8IF9oOwoKICAgICAgICAgIHJldHVybiBfYygnZGl2JywgewogICAgICAgICAgICByZWY6ICJwcm9ncmVzcyIKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBbXQogICAgICB9OwogICAgICBtb2R1bGUuZXhwb3J0cy5yZW5kZXIuX3dpdGhTdHJpcHBlZCA9IHRydWU7CgogICAgICBpZiAoZmFsc2UpIHsKICAgICAgICBtb2R1bGUuaG90LmFjY2VwdCgpOwoKICAgICAgICBpZiAobW9kdWxlLmhvdC5kYXRhKSB7CiAgICAgICAgICByZXF1aXJlKCJ2dWUtbG9hZGVyL25vZGVfbW9kdWxlcy92dWUtaG90LXJlbG9hZC1hcGkiKS5yZXJlbmRlcigiZGF0YS12LTA5YzQ0Y2RjIiwgbW9kdWxlLmV4cG9ydHMpOwogICAgICAgIH0KICAgICAgfQogICAgICAvKioqLwoKICAgIH0KICAgIC8qKioqKiovCiAgICBdKVsiZGVmYXVsdCJdCiAgKTsKfSk7"},null]}